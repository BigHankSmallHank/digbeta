%!TEX root = main.tex

\section{Introduction}
\label{sec:introduction}

This paper proposes a novel solution to recommend travel routes in cities. 
Large amount of location traces is becoming available from the ubiquitous location tracking devices. 
For example, FourSquare, the local search and discovery service has 50 million monthly users who have made 8 billion check-ins~\cite{4sq}; Flickr, the online photo-sharing site, hosts over 2 billion geo-tagged public photos~\cite{flickr}. Such large-amounts of travel data provides new opportunities for better 
traveling planning traditionally done with written travel guides, 
choosing and ranking locations for a variety of activities from dining to recreation, 
and potential new solutions to orienteering and routing problems. 
Good solutions to these problems will in turn lead to better urban experiences for residents and visitors alike, and foster sharing of even more location-based behavior data. 
\eat{
Location based information sharing services provided by online social media,
for example Facebook, Twitter and Flickr, generate data with geographical information,
together with time-stamps and user tags.
This enables us to identify the trajectory of a particular user as he or she travels through
a city. By combining trajectories of multiple users in a particular city, we
have an opportunity to explore patterns of tours. Using POI properties such as the type
or category of the site visited,
as well as transition patterns between different POIs,
we obtain a way to recommend high quality trajectories to travellers.
}

There are few common settings of recommendations problems for locations and routes, as illustrated in Figure~\ref{fig:threesettings}. 
The first setting can be called points-of-interest (POI) recommendation (Figure~\ref{fig:threesettings}(a)), here each location (e.g. A to E) is scored with geographic property and behavioral information such as category, reviews, popularity, spatial information such as distance and travel time uncertainty, and temporal information such as time of the day or day or the week.  There is a rich collection of recent literature on this problem~\cite{bao2015recommendations,yin2015joint,shi2011personalized,lian2014geomf,liu2014exploiting,yuan2013timeaware,hsieh2014mining,gao2013temporal,yuan2014graph}, including recent surveys~\cite{bao2015recommendations,zheng2014urban}. 
Figure~\ref{fig:threesettings}(b) illustrates the problem of next location recommendation\cite{ijcai13,aaai16,baraglia2013learnext,zhang2015location}, here the input is a partial trajectory (e.g. started at point A and currently at point B), the task of the algorithm is to score the next candidate location (e.g, C, D and E) based on the perceived POI score and transition compatibility with input $A\rightarrow B$. 
    The last setting is route recommendation, as illustrated in Figure~\ref{fig:threesettings}(c). Here the input are some deciding factors about the desired route, e.g. starting point A and end point C, along with auxiliary information such as the desired length of trip. The algorithm needs to take into account location desirability (as indicated by node size) and transition compatibility (as indicated by edge width), and compare route hypotheses such as A-D-B-C and A-E-D-C. Existing work in this area either uses heuristic combinations of location and routes~\cite{ijcai15,lu2012personalized}, or formulates an optimization problem that were not informed or evaluated by behavior history~\cite{gioniswsdm14,chen2015tripplanner}. Joint learning of locations preferences and routes remains an open problem.

\begin{figure*}[t]
	\centering
	\includegraphics[width=\textwidth]{fig/fig1-flavours.pdf}
	\caption{A figure illustrating different settings/flavours of trajectory recommendation problems. Namely: POI recommendation, next location, and trajectory/tour recommendation.
}
	\label{fig:threesettings}
\end{figure*}


We propose using learning to rank to capture the properties of POIs, as well as a Markov chain to
represent the transition patterns between POIs.
We factorise the transition probabilities of the Markov chain between POIs
according to several POI features to deal with data sparsity.
We combine the results of learning to rank and the factorized Markov Chain using both a probabilistic model and a structured
support vector machine, and evaluate the quality of POIs in recommended trajectories in terms of trajectory F$_1$-score~\cite{ijcai15}. One problem with the F$_1$-score on POIs is that it ignores
the order in which sites are visited.
We propose a new performance measure by applying F$_1$-score on pairs of POIs.
Experimental results on five trajectory datasets show performance improvements over the state-of-the-art methods and
reveal many interesting properties of trajectories in different datasets.


The main contribution of this work is as follows: 
\begin{itemize}
\item joint optimization of point preference and route plan;
\item feature-driven, incorporates information about time, location, POI categories and behavior history
\item strong performance compared to IJCAI 2015. we can also quantify the contribution from both point ranking and routing.
\item F1 on pairs.
\end{itemize}
